
(hugs) samk@capoo:~/projects/ml-hugs$ clear
(hugs) samk@capoo:~/projects/ml-hugs$ python main.py --cfg_file cfg_files/release/neuman/hugs_human_scene.yaml dataset.seq=lab
Experiment hyperparams:
    dataset.seq, vals=['lab', 'citron', 'seattle', 'bike', 'jogging', 'parkinglot']
6it [00:00, 12932.08it/s]
2025-05-02 12:51:14.416 | INFO     | __main__:<module>:95 - Running 6 experiments
2025-05-02 12:51:14.416 | INFO     | __main__:<module>:105 - Running experiment 0 -- demo-dataset.seq=lab
2025-05-02 12:51:14.438 | INFO     | __main__:get_logger:53 - Logging to output/human_scene/neuman/lab/hugs_trimlp/demo-dataset.seq=lab/2025-05-02_12-51-14
2025-05-02 12:51:14.446 | INFO     | __main__:get_logger:54 - seed: 0
mode: human_scene
output_path: output
cfg_file: cfg_files/release/neuman/hugs_human_scene.yaml
exp_name: demo-dataset.seq=lab
dataset_path: ''
detect_anomaly: false
debug: false
wandb: false
logdir: output/human_scene/neuman/lab/hugs_trimlp/demo-dataset.seq=lab/2025-05-02_12-51-14
logdir_ckpt: output/human_scene/neuman/lab/hugs_trimlp/demo-dataset.seq=lab/2025-05-02_12-51-14/ckpt
eval: false
bg_color: white
dataset:
  name: neuman
  seq: lab
train:
  batch_size: 1
  num_workers: 0
  num_steps: 14998
  save_ckpt_interval: 15000
  val_interval: 1000
  anim_interval: 15000
  optim_scene: true
  save_progress_images: false
  progress_save_interval: 10
human:
  name: hugs_trimlp
  ckpt: null
  sh_degree: 0
  n_subdivision: 2
  only_rgb: false
  use_surface: false
  use_deformer: true
  init_2d: false
  disable_posedirs: true
  res_offset: false
  rotate_sh: false
  isotropic: false
  init_scale_multiplier: 0.5
  run_init: false
  estimate_delta: true
  triplane_res: 128
  optim_pose: true
  optim_betas: false
  optim_trans: true
  optim_eps_offsets: false
  activation: relu
  canon_nframes: 60
  canon_pose_type: da_pose
  knn_n_hops: 3
  lr:
    wd: 0.0
    position: 0.00016
    position_init: 0.00016
    position_final: 1.6e-06
    position_delay_mult: 0.01
    position_max_steps: 30000
    opacity: 0.05
    scaling: 0.005
    rotation: 0.001
    feature: 0.0025
    smpl_spatial: 2.0
    smpl_pose: 0.0001
    smpl_betas: 0.0001
    smpl_trans: 0.0001
    smpl_eps_offset: 0.0001
    lbs_weights: 0.0
    posedirs: 0.0
    percent_dense: 0.01
    appearance: 0.001
    geometry: 0.001
    vembed: 0.001
    deformation: 0.0001
    scale_lr_w_npoints: false
  loss:
    ssim_w: 0.2
    l1_w: 0.8
    lpips_w: 1.0
    lbs_w: 1000.0
    humansep_w: 1.0
    num_patches: 4
    patch_size: 128
    use_patches: 1
  densification_interval: 600
  opacity_reset_interval: 3000
  densify_from_iter: 3000
  densify_until_iter: 15000
  densify_grad_threshold: 0.0002
  prune_min_opacity: 0.005
  densify_extent: 1.0
  max_n_gaussians: 131072
  percent_dense: 0.01
scene:
  name: scene_gs
  ckpt: null
  sh_degree: 3
  add_bg_points: false
  num_bg_points: 204800
  bg_sphere_dist: 5.0
  clean_pcd: false
  opt_start_iter: -1
  lr:
    percent_dense: 0.01
    spatial_scale: 1.0
    position_init: 0.00016
    position_final: 1.6e-06
    position_delay_mult: 0.01
    position_max_steps: 30000
    opacity: 0.05
    scaling: 0.005
    rotation: 0.001
    feature: 0.0025
  percent_dense: 0.01
  densification_interval: 100
  opacity_reset_interval: 20000
  densify_from_iter: 500
  densify_until_iter: 15000
  densify_grad_threshold: 0.0002
  prune_min_opacity: 0.005
  max_n_gaussians: 131072
  loss:
    ssim_w: 0.2
    l1_w: 0.8

2025-05-02 12:51:14.454 | INFO     | hugs.trainer.gs_trainer:get_train_dataset:39 - Loading NeuMan dataset lab-train
reading cameras: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 24966.10it/s]
reading images meta: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 103/103 [00:00<00:00, 5549.87it/s]
reading point cloud: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9013/9013 [00:00<00:00, 192498.61it/s]
Computing near/far for ['bkg']: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 103/103 [00:00<00:00, 469.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 82/82 [00:04<00:00, 16.82it/s]
2025-05-02 12:51:19.774 | INFO     | hugs.trainer.gs_trainer:get_val_dataset:54 - Loading NeuMan dataset lab-val
reading cameras: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 29127.11it/s]
reading images meta: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 103/103 [00:00<00:00, 5634.71it/s]
reading point cloud: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9013/9013 [00:00<00:00, 198496.50it/s]
Computing near/far for ['bkg']: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 103/103 [00:00<00:00, 615.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:00<00:00, 17.35it/s]
2025-05-02 12:51:20.704 | INFO     | hugs.trainer.gs_trainer:get_anim_dataset:62 - Loading NeuMan dataset lab-anim
reading cameras: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 28339.89it/s]
reading images meta: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 103/103 [00:00<00:00, 5714.99it/s]
reading point cloud: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9013/9013 [00:00<00:00, 199531.63it/s]
Computing near/far for ['bkg']: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 103/103 [00:00<00:00, 619.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 1250.22it/s]
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/home/samk/anaconda3/envs/hugs/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/samk/anaconda3/envs/hugs/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current beh
avior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /home/samk/anaconda3/envs/hugs/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
2025-05-02 12:51:22.318 | INFO     | hugs.models.hugs_trimlp:create_betas:139 - Created betas with shape: torch.Size([10]), requires_grad: False
2025-05-02 12:51:22.333 | INFO     | hugs.models.hugs_trimlp:__init__:109 - Subdividing SMPL model 2 times
# vertices before subdivision: (6890, 3)
# vertices before subdivision: (27554, 3)
/home/samk/projects/ml-hugs/hugs/models/hugs_trimlp.py:120: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may
want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541702/work/
torch/csrc/utils/tensor_numpy.cpp:199.)
  self.edges = torch.from_numpy(edges).to(self.device).long()
2025-05-02 12:51:31.100 | INFO     | hugs.models.hugs_trimlp:create_betas:139 - Created betas with shape: torch.Size([10]), requires_grad: False
^[[A^[[B2025-05-02 12:52:17.484 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: xyz, lr: 0.00032
2025-05-02 12:52:17.485 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: v_embed, lr: 0.001
2025-05-02 12:52:17.485 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: geometry_dec, lr: 0.001
2025-05-02 12:52:17.485 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: appearance_dec, lr: 0.001
2025-05-02 12:52:17.485 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: deform_dec, lr: 0.0005
===== Ground truth values: =====
xyz_offsets torch.Size([110210, 3])
scales torch.Size([110210, 3])
rot6d_canon torch.Size([110210, 6])
shs torch.Size([110210, 16, 3])
opacity torch.Size([110210, 1])
lbs_weights torch.Size([110210, 24])
posedirs torch.Size([207, 330630])
deformed_normals torch.Size([110210, 3])
faces torch.Size([13776, 3])
edges torch.Size([330624, 2])
================================
2025-05-02 13:03:24.053 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: xyz, lr: 0.00032hs: 0.0000001, loss_opacity: 0.0000001, loss_lbs_weights: 0.0000095)6)
2025-05-02 13:03:24.053 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: v_embed, lr: 0.001
2025-05-02 13:03:24.054 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: geometry_dec, lr: 0.001
2025-05-02 13:03:24.054 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: appearance_dec, lr: 0.001
2025-05-02 13:03:24.054 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: deform_dec, lr: 0.0001
2025-05-02 13:03:24.055 | INFO     | hugs.trainer.gs_trainer:__init__:128 - HUGS TRIMLP:
xyz: torch.Size([110210, 3])
max_radii2D: torch.Size([110210])
xyz_gradient_accum: torch.Size([110210, 1])
denom: torch.Size([110210, 1])

2025-05-02 13:03:24.057 | INFO     | hugs.models.hugs_trimlp:create_betas:139 - Created betas with shape: torch.Size([10]), requires_grad: False
2025-05-02 13:03:24.060 | INFO     | hugs.models.hugs_trimlp:create_body_pose:130 - Created body pose with shape: torch.Size([82, 138]), requires_grad: True
2025-05-02 13:03:24.061 | INFO     | hugs.models.hugs_trimlp:create_global_orient:135 - Created global_orient with shape: torch.Size([82, 6]), requires_grad: True
2025-05-02 13:03:24.062 | INFO     | hugs.models.hugs_trimlp:create_transl:143 - Created transl with shape: torch.Size([82, 3]), requires_grad: True
2025-05-02 13:03:24.062 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: xyz, lr: 0.00032
2025-05-02 13:03:24.063 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: v_embed, lr: 0.001
2025-05-02 13:03:24.063 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: geometry_dec, lr: 0.001
2025-05-02 13:03:24.063 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: appearance_dec, lr: 0.001
2025-05-02 13:03:24.063 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: deform_dec, lr: 0.0001
2025-05-02 13:03:24.064 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: global_orient, lr: 0.0001
2025-05-02 13:03:24.064 | INFO     | hugs.models.hugs_trimlp:setup_optimizer:699 - Parameter: body_pose, lr: 0.0001
2025-05-02 13:03:24.064 | INFO     | hugs.trainer.gs_trainer:__init__:157 - SceneGS:
xyz: torch.Size([0])
features_dc: torch.Size([0])
features_rest: torch.Size([0])
scaling: torch.Size([0])
rotation: torch.Size([0])
opacity: torch.Size([0])
max_radii2D: torch.Size([0])
xyz_gradient_accum: torch.Size([0])
denom: torch.Size([0])

2025-05-02 13:03:24.066 | INFO     | hugs.models.scene:create_from_pcd:179 - Number of scene points at initialisation: 9013
2025-05-02 13:03:24.072 | INFO     | hugs.models.scene:setup_optimizer:211 - Parameter: xyz, lr: 0.001990651550292969
2025-05-02 13:03:24.073 | INFO     | hugs.models.scene:setup_optimizer:211 - Parameter: f_dc, lr: 0.0025
2025-05-02 13:03:24.073 | INFO     | hugs.models.scene:setup_optimizer:211 - Parameter: f_rest, lr: 0.000125
2025-05-02 13:03:24.073 | INFO     | hugs.models.scene:setup_optimizer:211 - Parameter: opacity, lr: 0.05
2025-05-02 13:03:24.073 | INFO     | hugs.models.scene:setup_optimizer:211 - Parameter: scaling, lr: 0.005
2025-05-02 13:03:24.074 | INFO     | hugs.models.scene:setup_optimizer:211 - Parameter: rotation, lr: 0.001
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
/home/samk/anaconda3/envs/hugs/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current beh
avior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /home/samk/anaconda3/envs/hugs/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
Canonical:: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 60/60 [00:03<00:00, 18.76it/s]
2025-05-02 13:03:30.421 | INFO     | hugs.utils.general:create_video:91 - Video is saved under output/human_scene/neuman/lab/hugs_trimlp/demo-dataset.seq=lab/2025-05-02_12-51-14/canon_neuman_lab_000000.mp4███| 60/60 [00:03<00:00, 19.17it/s]
Training:   3%| | 500/14999 [02:28<1:09:01,  3.50it/s, #hp=110.2K, #sp=9.0K, h_sh_d=0, s_sh_d=0, l_l1=0.0383, l_ssim=0.0507, l_lpips_patch=0.3135, l_l1_human=0.2082, l_ssim_human=0.0007, l_lpips_patch_human=0.2122, l_lbs=0.4382, l_loss=1.26
2025-05-02 13:05:56.314 | INFO     | hugs.trainer.gs_trainer:scene_densification:426 - [000500] Resetting opacity!!!
Training:   4%| | 580/14999 [02:51<1:10:02,  3.43it/s, #hp=110.2K, #sp=9.0K, h_sh_d=0, s_sh_d=0, l_l1=0.0415, l_ssim=0.0488, l_lpips_patch=0.3752, l_l1_human=0.2035, l_ssim_human=0.0003, l_lpips_patch_human=0.2021, l_lbs=0.3860, l_loss=1.25
Training:   4%| | 620/14999 [03:03<1:09:54,  3.43it/s, #hp=110.2K, #sp=10.8K, h_sh_d=0, s_sh_d=0, l_l1=0.0433, l_ssim=0.0466, l_lpips_patch=0.3318, l_l1_human=0.2500, l_ssim_human=0.0006, l_lpips_patch_human=0.2341, l_lbs=0.4114, l_loss=1.3

// log as of 2025-05-02 13:05:56